<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, user-scalable=yes"
    />
    <meta name="robots" content="noindex,nofollow,noarchive" />

    <script>
      MathJax = {
        chtml: {
          displayAlign: "left",
          displayIndent: "1em",
        },
      };
    </script>

     <script
src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js"
type="text/javascript"></script> 

    <link rel="icon" href="favicon.ico" sizes="any" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css"
      integrity="sha512-SzlrxWUlpfuzQ+pcUCosxcglQRNAq/DZjVsC0lE40xsADsfeQoEypE+enwcOiGjk/bSuGGKHEyjSoQ1zVisanQ=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css?family=M+PLUS+Rounded+1c"
    />
    <link rel="stylesheet" href="style.css" />

    <title>JavaScript でゲームを作ろう</title>
  </head>

  <body>
    <div class="openbtn"><span></span><span></span><span></span></div>
    <nav id="g-nav">
      <div id="g-nav-list">
        <!-- ---------------------------------------- -->
         <ul>
<li><a href="#概要" id="toc-概要"><span
class="toc-section-number">1</span> 概要</a>
<ul>
<li><a href="#前回の復習" id="toc-前回の復習"><span
class="toc-section-number">1.1</span> 前回の復習</a></li>
<li><a href="#今回の講義の達成目標" id="toc-今回の講義の達成目標"><span
class="toc-section-number">1.2</span> 今回の講義の達成目標</a></li>
</ul></li>
<li><a href="#document-オブジェクト"
id="toc-document-オブジェクト"><span class="toc-section-number">2</span>
Document オブジェクト</a>
<ul>
<li><a href="#document-オブジェクトとは"
id="toc-document-オブジェクトとは"><span
class="toc-section-number">2.1</span> Document オブジェクトとは</a></li>
<li><a href="#html-要素の取得" id="toc-html-要素の取得"><span
class="toc-section-number">2.2</span> HTML 要素の取得</a></li>
<li><a href="#要素の大きさを取得" id="toc-要素の大きさを取得"><span
class="toc-section-number">2.3</span> 要素の大きさを取得</a></li>
<li><a href="#ウィンドウの大きさを取得"
id="toc-ウィンドウの大きさを取得"><span
class="toc-section-number">2.4</span> ウィンドウの大きさを取得</a></li>
<li><a href="#html-要素の変更" id="toc-html-要素の変更"><span
class="toc-section-number">2.5</span> HTML 要素の変更</a></li>
<li><a href="#新しい要素の作成" id="toc-新しい要素の作成"><span
class="toc-section-number">2.6</span> 新しい要素の作成</a></li>
</ul></li>
<li><a href="#webkitcssmatrix" id="toc-webkitcssmatrix"><span
class="toc-section-number">3</span> WebKitCSSMatrix</a></li>
<li><a href="#イベントハンドリング" id="toc-イベントハンドリング"><span
class="toc-section-number">4</span> イベントハンドリング</a>
<ul>
<li><a href="#イベントリスナーの追加"
id="toc-イベントリスナーの追加"><span
class="toc-section-number">4.1</span> イベントリスナーの追加</a></li>
<li><a href="#イベントリスナーの削除"
id="toc-イベントリスナーの削除"><span
class="toc-section-number">4.2</span> イベントリスナーの削除</a></li>
</ul></li>
<li><a href="#距離計算" id="toc-距離計算"><span
class="toc-section-number">5</span> 距離計算</a></li>
<li><a href="#まとめ" id="toc-まとめ"><span
class="toc-section-number">6</span> まとめ</a></li>
</ul> 
        <!-- ---------------------------------------- -->
      </div>
    </nav>

    <header class="markdown-body">
      <p>オンラインテキストテンプレート</p>
      <p>2024/04/23</p>
    </header>

    <main class="markdown-body">
      <!-- ---------------------------------------- -->
      <h1 data-number="1" id="概要"><span
      class="header-section-number">1</span> 概要</h1>
      <h2 data-number="1.1" id="前回の復習"><span
      class="header-section-number">1.1</span> 前回の復習</h2>
      <ul>
      <li>JavaScript の書き方について学んだ</li>
      </ul>
      <h2 data-number="1.2" id="今回の講義の達成目標"><span
      class="header-section-number">1.2</span> 今回の講義の達成目標</h2>
      <div class="note type-intro">
      <p><strong>達成目標</strong></p>
      <p>・ゲームに使用している関数などについて学ぼう</p>
      </div>
      <h1 data-number="2" id="document-オブジェクト"><span
      class="header-section-number">2</span> Document オブジェクト</h1>
      <h2 data-number="2.1" id="document-オブジェクトとは"><span
      class="header-section-number">2.1</span> Document
      オブジェクトとは</h2>
      <ul>
      <li><p>Document オブジェクトは、Web
      ページ全体を表すオブジェクトであり、HTML
      文書全体を操作するためのインターフェースを提供します。JavaScript
      を使用して、HTML 要素の取得や変更、新しい要素の作成などを行う際に
      Document オブジェクトが活用されます。</p></li>
      <li><p>今回作成するゲームにて、テキストやボタンの位置、色などの変更はこれらによって指定されています。</p></li>
      <li><p>Document オブジェクトは通常、<code>document</code>
      変数を介してアクセスされます。</p></li>
      </ul>
      <h2 data-number="2.2" id="html-要素の取得"><span
      class="header-section-number">2.2</span> HTML 要素の取得</h2>
      <ul>
      <li>Document オブジェクトを使用すると、HTML
      要素を取得することができます。以下は、要素を取得する例です。</li>
      </ul>
      <figure>
      <img src="figs/js/document.getElementByID.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <ul>
      <li>このコードで変数に代入することで、要素に様々なことをすることができるようになるぞ！</li>
      </ul>
      <div class="sourceCode" id="cb1" data-caption="index.html"><pre
      class="sourceCode html"><code class="sourceCode html"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;myElement&quot;</span><span class="ot"> class</span><span class="op">=</span><span class="st">&quot;myClass&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">script</span><span class="ot"> src</span><span class="op">=</span><span class="st">&quot;main.js&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">script</span><span class="dt">&gt;</span></span></code></pre></div>
      <div class="sourceCode" id="cb2" data-caption="main.js"><pre
      class="sourceCode numberSource javascript numberLines"><code class="sourceCode javascript"><span id="cb2-1"><a href="#cb2-1"></a><span class="co">// IDを使用して要素を取得</span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="kw">let</span> elementById <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;myElement&quot;</span>)<span class="op">;</span></span>
<span id="cb2-3"><a href="#cb2-3"></a></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="co">// クラス名を使用して要素を取得</span></span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="kw">let</span> elementsByClass <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementsByClassName</span>(<span class="st">&quot;myClass&quot;</span>)<span class="op">;</span></span>
<span id="cb2-6"><a href="#cb2-6"></a></span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="co">// タグ名を使用して要素を取得</span></span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="kw">let</span> elementsByTag <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementsByTagName</span>(<span class="st">&quot;div&quot;</span>)<span class="op">;</span></span></code></pre></div>
      <ul>
      <li><p>今回の例だと、全て同じ要素を取得しています。</p></li>
      <li><p>これらを取得することによって、その HTML
      要素の文字や色あどが JavaScript
      で変更できるようになります。</p></li>
      </ul>
      <h2 data-number="2.3" id="要素の大きさを取得"><span
      class="header-section-number">2.3</span> 要素の大きさを取得</h2>
      <ul>
      <li><p>先程取得したものを使って、要素の大きさを取得することができます。</p></li>
      <li><p>リンクしている HTML
      ファイルの中に、<code>content</code>という名前の ID
      属性が付けられているとすると、その要素の大きさを取得するには、<code>offset</code>プロパティを使います。</p></li>
      </ul>
      <div class="sourceCode" id="cb3" data-caption="main.js"><pre
      class="sourceCode numberSource javascript numberLines"><code class="sourceCode javascript"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw">let</span> elem <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;content&quot;</span>)<span class="op">;</span></span>
<span id="cb3-2"><a href="#cb3-2"></a></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="co">// 幅を取得</span></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="kw">let</span> elemWidth <span class="op">=</span> elem<span class="op">.</span><span class="at">offsetWidth</span><span class="op">;</span></span>
<span id="cb3-5"><a href="#cb3-5"></a></span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="co">// 高さを取得</span></span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="kw">let</span> elemHeight <span class="op">=</span> elem<span class="op">.</span><span class="at">offsetHeight</span><span class="op">;</span></span></code></pre></div>
      <ul>
      <li>では、h1 タグに ID
      属性を付けて、それの幅と高さをコンソールに出力してみよう。</li>
      </ul>
      <div class="sourceCode" id="cb4" data-caption="index.html"><pre
      class="sourceCode numberSource html numberLines"><code class="sourceCode html"><span id="cb4-1"><a href="#cb4-1"></a><span class="dt">&lt;!DOCTYPE</span> html<span class="dt">&gt;</span></span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="dt">&lt;</span><span class="kw">html</span><span class="ot"> lang</span><span class="op">=</span><span class="st">&quot;ja&quot;</span><span class="dt">&gt;</span></span>
<span id="cb4-3"><a href="#cb4-3"></a>    <span class="dt">&lt;</span><span class="kw">head</span><span class="dt">&gt;</span></span>
<span id="cb4-4"><a href="#cb4-4"></a>        <span class="dt">&lt;</span><span class="kw">meta</span><span class="ot"> charset</span><span class="op">=</span><span class="st">&quot;UTF-8&quot;</span><span class="ot"> </span><span class="dt">/&gt;</span></span>
<span id="cb4-5"><a href="#cb4-5"></a>        <span class="dt">&lt;</span><span class="kw">meta</span><span class="ot"> name</span><span class="op">=</span><span class="st">&quot;viewport&quot;</span><span class="ot"> content</span><span class="op">=</span><span class="st">&quot;width=device-width, initial-scale=1.0&quot;</span><span class="ot"> </span><span class="dt">/&gt;</span></span>
<span id="cb4-6"><a href="#cb4-6"></a>        <span class="dt">&lt;</span><span class="kw">title</span><span class="dt">&gt;</span>解答<span class="dt">&lt;/</span><span class="kw">title</span><span class="dt">&gt;</span></span>
<span id="cb4-7"><a href="#cb4-7"></a>        <span class="dt">&lt;</span><span class="kw">link</span><span class="ot"> rel</span><span class="op">=</span><span class="st">&quot;stylesheet&quot;</span><span class="ot"> href</span><span class="op">=</span><span class="st">&quot;style.css&quot;</span><span class="ot"> </span><span class="dt">/&gt;</span></span>
<span id="cb4-8"><a href="#cb4-8"></a>    <span class="dt">&lt;/</span><span class="kw">head</span><span class="dt">&gt;</span></span>
<span id="cb4-9"><a href="#cb4-9"></a>    <span class="dt">&lt;</span><span class="kw">body</span><span class="dt">&gt;</span></span>
<span id="cb4-10"><a href="#cb4-10"></a>        <span class="dt">&lt;</span><span class="kw">h1</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;content&quot;</span><span class="dt">&gt;</span>こんにちは！！！！！！<span class="dt">&lt;/</span><span class="kw">h1</span><span class="dt">&gt;</span></span>
<span id="cb4-11"><a href="#cb4-11"></a>        <span class="dt">&lt;</span><span class="kw">script</span><span class="ot"> src</span><span class="op">=</span><span class="st">&quot;main.js&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">script</span><span class="dt">&gt;</span></span>
<span id="cb4-12"><a href="#cb4-12"></a>    <span class="dt">&lt;/</span><span class="kw">body</span><span class="dt">&gt;</span></span>
<span id="cb4-13"><a href="#cb4-13"></a><span class="dt">&lt;/</span><span class="kw">html</span><span class="dt">&gt;</span></span></code></pre></div>
      <div class="sourceCode" id="cb5" data-caption="style.css"><pre
      class="sourceCode numberSource css numberLines"><code class="sourceCode css"><span id="cb5-1"><a href="#cb5-1"></a><span class="co">/*色を変えて大きさが分かりやすいようにする*/</span></span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="pp">#content</span> {</span>
<span id="cb5-3"><a href="#cb5-3"></a>    <span class="kw">background-color</span><span class="ch">:</span> <span class="cn">chartreuse</span><span class="op">;</span></span>
<span id="cb5-4"><a href="#cb5-4"></a>}</span></code></pre></div>
      <div class="sourceCode" id="cb6" data-caption="main.js"><pre
      class="sourceCode numberSource javascript numberLines"><code class="sourceCode javascript"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw">let</span> elem <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;content&quot;</span>)<span class="op">;</span></span>
<span id="cb6-2"><a href="#cb6-2"></a></span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="co">// 幅を取得</span></span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="kw">let</span> elemWidth <span class="op">=</span> elem<span class="op">.</span><span class="at">offsetWidth</span><span class="op">;</span></span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="co">// 高さを取得</span></span>
<span id="cb6-6"><a href="#cb6-6"></a><span class="kw">let</span> elemHeight <span class="op">=</span> elem<span class="op">.</span><span class="at">offsetHeight</span><span class="op">;</span></span>
<span id="cb6-7"><a href="#cb6-7"></a></span>
<span id="cb6-8"><a href="#cb6-8"></a><span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(elemWidth)<span class="op">;</span></span>
<span id="cb6-9"><a href="#cb6-9"></a></span>
<span id="cb6-10"><a href="#cb6-10"></a><span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(elemHeight)<span class="op">;</span></span></code></pre></div>
      <ul>
      <li>コンソールに表示されていれば成功です！</li>
      </ul>
      <figure>
      <img src="figs/js/youso_haba.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <ul>
      <li>また、左上を原点としてときに要素がどの高さにあるのかを見るには、<code>offsetTop</code>を使います。</li>
      </ul>
      <h2 data-number="2.4" id="ウィンドウの大きさを取得"><span
      class="header-section-number">2.4</span>
      ウィンドウの大きさを取得</h2>
      <ul>
      <li>ウィンドウの大きさを取得するには、以下のコードを使います。</li>
      </ul>
      <div class="sourceCode" id="cb7" data-caption="main.js"><pre
      class="sourceCode numberSource javascript numberLines"><code class="sourceCode javascript"><span id="cb7-1"><a href="#cb7-1"></a><span class="kw">const</span> Width <span class="op">=</span> <span class="bu">window</span><span class="op">.</span><span class="at">innerWidth</span><span class="op">;</span></span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="kw">const</span> Height <span class="op">=</span> <span class="bu">window</span><span class="op">.</span><span class="at">innerHeight</span><span class="op">;</span></span></code></pre></div>
      <div class="note type-quiz">
      Q. ウィンドウの幅と高さを取得して、コンソールの出力してみよう。
      <div class="quizes">
      <div class="options">
      <div class="option correct">
      答えを見る
      </div>
      </div>
      <div class="answercontent">
      <p>答えの一例です。</p>
      <div class="sourceCode" id="cb8" data-caption="main.js"><pre
      class="sourceCode numberSource javascript numberLines"><code class="sourceCode javascript"><span id="cb8-1"><a href="#cb8-1"></a><span class="kw">const</span> Width <span class="op">=</span> <span class="bu">window</span><span class="op">.</span><span class="at">innerWidth</span><span class="op">;</span></span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="kw">const</span> Height <span class="op">=</span> <span class="bu">window</span><span class="op">.</span><span class="at">innerHeight</span><span class="op">;</span></span>
<span id="cb8-3"><a href="#cb8-3"></a></span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(Width)<span class="op">;</span></span>
<span id="cb8-5"><a href="#cb8-5"></a><span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(Height)<span class="op">;</span></span></code></pre></div>
      <iframe height="300" style="width: 100%;" scrolling="no" title="Untitled" src="https://codepen.io/YasaiRa-men/embed/bNberRE?default-tab=html%2Cresult&amp;editable=true" frameborder="no" loading="lazy" allowtransparency="true" allowfullscreen="true">
      See the Pen <a href="https://codepen.io/YasaiRa-men/pen/bNberRE">
      Untitled</a> by バナナフライ
      (<a href="https://codepen.io/YasaiRa-men"><span class="citation"
      data-cites="YasaiRa-men">@YasaiRa-men</span></a>) on
      <a href="https://codepen.io">CodePen</a>.
      </iframe>
      <ul>
      <li>以下の動画から、幅や高さを変えてからサイトを更新すると、コンソールの中の値が変わっているのが分かります。</li>
      </ul>
      <figure>
      <img src="figs/js/haba.gif" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      </div>
      </div>
      </div>
      <ul>
      <li><code>offset</code>と<code>inner</code>で違ってくるので注意！</li>
      </ul>
      <h2 data-number="2.5" id="html-要素の変更"><span
      class="header-section-number">2.5</span> HTML 要素の変更</h2>
      <ul>
      <li>ひとまず、HTML をこのように書いてみよう。</li>
      </ul>
      <div class="sourceCode" id="cb9" data-caption="index.html"><pre
      class="sourceCode html"><code class="sourceCode html"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">p</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;myElement&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">p</span><span class="dt">&gt;</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">script</span><span class="ot"> src</span><span class="op">=</span><span class="st">&quot;main.js&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">script</span><span class="dt">&gt;</span></span></code></pre></div>
      <ul>
      <li>Document
      オブジェクトを使用して、<em>textContent</em>で取得した HTML
      要素の内容を変更することができます。以下は、要素の内容を変更する例です。</li>
      </ul>
      <div class="sourceCode" id="cb10" data-caption="main.js"><pre
      class="sourceCode numberSource javascript numberLines"><code class="sourceCode javascript"><span id="cb10-1"><a href="#cb10-1"></a><span class="kw">let</span> element <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;myElement&quot;</span>)<span class="op">;</span></span>
<span id="cb10-2"><a href="#cb10-2"></a>element<span class="op">.</span><span class="at">textContent</span> <span class="op">=</span> <span class="st">&quot;新しいテキスト&quot;</span><span class="op">;</span></span></code></pre></div>
      <iframe height="300" style="width: 100%;" scrolling="no" title="Untitled" src="https://codepen.io/YasaiRa-men/embed/NWVNdmK?default-tab=html%2Cresult&amp;editable=true" frameborder="no" loading="lazy" allowtransparency="true" allowfullscreen="true">
      See the Pen <a href="https://codepen.io/YasaiRa-men/pen/NWVNdmK">
      Untitled</a> by バナナフライ
      (<a href="https://codepen.io/YasaiRa-men"><span class="citation"
      data-cites="YasaiRa-men">@YasaiRa-men</span></a>) on
      <a href="https://codepen.io">CodePen</a>.
      </iframe>
      <p>また、<em>style</em>で css
      のスタイルを変更することができます。以下は、要素の内容を変更する例です。</p>
      <div class="sourceCode" id="cb11" data-caption="main.js"><pre
      class="sourceCode numberSource javascript numberLines"><code class="sourceCode javascript"><span id="cb11-1"><a href="#cb11-1"></a><span class="kw">let</span> element <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;myElement&quot;</span>)<span class="op">;</span></span>
<span id="cb11-2"><a href="#cb11-2"></a>element<span class="op">.</span><span class="at">textContent</span> <span class="op">=</span> <span class="st">&quot;新しいテキスト&quot;</span><span class="op">;</span></span>
<span id="cb11-3"><a href="#cb11-3"></a>element<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">color</span> <span class="op">=</span> <span class="st">&quot;red&quot;</span><span class="op">;</span></span></code></pre></div>
      <iframe height="300" style="width: 100%;" scrolling="no" title="Untitled" src="https://codepen.io/YasaiRa-men/embed/MWdyJRj?default-tab=html%2Cresult&amp;editable=true" frameborder="no" loading="lazy" allowtransparency="true" allowfullscreen="true">
      See the Pen <a href="https://codepen.io/YasaiRa-men/pen/MWdyJRj">
      Untitled</a> by バナナフライ
      (<a href="https://codepen.io/YasaiRa-men"><span class="citation"
      data-cites="YasaiRa-men">@YasaiRa-men</span></a>) on
      <a href="https://codepen.io">CodePen</a>.
      </iframe>
      <div class="note type-quiz">
      <p>Q.
      以下のHTMLのp要素に「こんにちは」という文字を入れ、の背景を青に、横幅を100%にしよう。</p>
      <div class="sourceCode" id="cb12" data-caption="index.html"><pre
      class="sourceCode html"><code class="sourceCode html"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">p</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;myElement&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">p</span><span class="dt">&gt;</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">script</span><span class="ot"> src</span><span class="op">=</span><span class="st">&quot;main.js&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">script</span><span class="dt">&gt;</span></span></code></pre></div>
      <div class="quizes">
      <div class="options">
      <div class="option correct">
      答えを見る
      </div>
      </div>
      <div class="answercontent">
      <p>答えの一例です。
      <iframe height="300" style="width: 100%;" scrolling="no" title="Untitled" src="https://codepen.io/YasaiRa-men/embed/yLWVXjQ?default-tab=html%2Cresult" frameborder="no" loading="lazy" allowtransparency="true" allowfullscreen="true">
      See the Pen <a href="https://codepen.io/YasaiRa-men/pen/yLWVXjQ">
      Untitled</a> by バナナフライ
      (<a href="https://codepen.io/YasaiRa-men"><span class="citation"
      data-cites="YasaiRa-men">@YasaiRa-men</span></a>) on
      <a href="https://codepen.io">CodePen</a>. </iframe></p>
      </div>
      </div>
      </div>
      <h2 data-number="2.6" id="新しい要素の作成"><span
      class="header-section-number">2.6</span> 新しい要素の作成</h2>
      <ul>
      <li><p>JavaScript
      から新しく要素を作成したい場合、<code>insertAdjacentHTML</code>メソッドを使用します。</p></li>
      <li><p>insertAdjacentHTML は、HTML 要素の隣に指定した位置で新しい
      HTML
      コードを挿入するためのメソッドです。このメソッドを使うと、既存の要素を操作することなく、効率的に新しい内容を挿入できます。</p></li>
      </ul>
      <div class="sourceCode" id="cb13" data-caption="main.js"><pre
      class="sourceCode numberSource javascript numberLines"><code class="sourceCode javascript"><span id="cb13-1"><a href="#cb13-1"></a>element<span class="op">.</span><span class="fu">insertAdjacentHTML</span>(position<span class="op">,</span> htmlString)<span class="op">;</span></span></code></pre></div>
      <div class="note type-tips">
      <ul>
      <li>element: HTML を挿入する対象の要素。</li>
      <li>position: 挿入する位置を指定する文字列（以下の 4
      種類から選択）。</li>
      <li>htmlString: 挿入する HTML 文字列。</li>
      </ul>
      </div>
      <ul>
      <li>position は、どこに配置するかで、4 種類から選びます。</li>
      </ul>
      <table>
      <thead>
      <tr class="header">
      <th>値</th>
      <th>意味</th>
      </tr>
      </thead>
      <tbody>
      <tr class="odd">
      <td>“beforebegin”:</td>
      <td>要素の直前（要素の外側）</td>
      </tr>
      <tr class="even">
      <td>“afterbegin” :</td>
      <td>要素の最初の子要素の前（要素の内側）</td>
      </tr>
      <tr class="odd">
      <td>“beforeend” :</td>
      <td>要素の最後の子要素の後（要素の内側）</td>
      </tr>
      <tr class="even">
      <td>“afterend” :</td>
      <td>要素の直後（要素の外側）</td>
      </tr>
      </tbody>
      </table>
      <ul>
      <li>以下の CodePen からそれぞれの position
      でどこに追加されるか確認してみよう！</li>
      </ul>
      <iframe height="300" style="width: 100%;" scrolling="no" title="Untitled" src="https://codepen.io/YasaiRa-men/embed/dPbXzpg?default-tab=html%2Cresult&amp;editable=true" frameborder="no" loading="lazy" allowtransparency="true" allowfullscreen="true">
      See the Pen <a href="https://codepen.io/YasaiRa-men/pen/dPbXzpg">
      Untitled</a> by バナナフライ
      (<a href="https://codepen.io/YasaiRa-men"><span class="citation"
      data-cites="YasaiRa-men">@YasaiRa-men</span></a>) on
      <a href="https://codepen.io">CodePen</a>.
      </iframe>
      <h1 data-number="3" id="webkitcssmatrix"><span
      class="header-section-number">3</span> WebKitCSSMatrix</h1>
      <ul>
      <li>WebKitCSSMatrix は、CSS
      で使われる「変形（Transform）」の値を読み取ったり操作したりするための
      JavaScript オブジェクトです。 主に
      回転（rotate）、拡大縮小（scale）、移動（translate）
      などの値を取得したいときに使います。</li>
      </ul>
      <div class="sourceCode" id="cb14" data-caption="main.js"><pre
      class="sourceCode numberSource javascript numberLines"><code class="sourceCode javascript"><span id="cb14-1"><a href="#cb14-1"></a><span class="kw">let</span> target_element <span class="op">=</span> <span class="fu">documentgetElementById</span>(<span class="st">&quot;target&quot;</span>)<span class="op">;</span></span>
<span id="cb14-2"><a href="#cb14-2"></a></span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="co">// m41プロパティだとその要素のx座標</span></span>
<span id="cb14-4"><a href="#cb14-4"></a><span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="kw">new</span> <span class="fu">WebKitCSSMatrix</span>(target_element<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">transform</span>)<span class="op">.</span><span class="at">m41</span>)<span class="op">;</span></span>
<span id="cb14-5"><a href="#cb14-5"></a><span class="co">// m41プロパティだとその要素のy座標</span></span>
<span id="cb14-6"><a href="#cb14-6"></a><span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="kw">new</span> <span class="fu">WebKitCSSMatrix</span>(target_element<span class="op">.</span><span class="at">style</span><span class="op">.</span><span class="at">transform</span>)<span class="op">.</span><span class="at">m42</span>)<span class="op">;</span></span></code></pre></div>
      <ul>
      <li>今回のゲームでは、移動のみ使います。</li>
      </ul>
      <h1 data-number="4" id="イベントハンドリング"><span
      class="header-section-number">4</span> イベントハンドリング</h1>
      <ul>
      <li>イベントハンドリングは、ユーザーからの入力やアクションに応じてプログラムが反応する方法です
      JavaScript を使用すると、Web
      ページ上のイベントを捕捉し、特定の処理を実行することができます。</li>
      </ul>
      <div class="sourceCode" id="cb15" data-caption="main.js"><pre
      class="sourceCode numberSource javascript numberLines"><code class="sourceCode javascript"><span id="cb15-1"><a href="#cb15-1"></a><span class="bu">document</span><span class="op">.</span><span class="fu">addEventListener</span>(イベント<span class="op">,</span> <span class="kw">function</span>() {</span>
<span id="cb15-2"><a href="#cb15-2"></a>  <span class="co">// イベントが行われたときに実行されるところ</span></span>
<span id="cb15-3"><a href="#cb15-3"></a>  <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="st">&quot;イベントが発生しました。&quot;</span>)<span class="op">;</span></span>
<span id="cb15-4"><a href="#cb15-4"></a>})<span class="op">;</span></span></code></pre></div>
      <ul>
      <li><p>イベントハンドリングはこのようにして追加することができます。（イベントについては後ほど解説します）</p></li>
      <li><p>addEventListener の前の document
      について、<code>document</code>だと Web
      全体でイベントを監視していて、特定の要素内でイベントを監視したいときには、Document
      オブジェクトを書いてあげることで実現できます。</p></li>
      <li><p>また、イベントで行われる関数には、引数を設定することができ、この引数を使って様々なことができます。</p></li>
      </ul>
      <div class="sourceCode" id="cb16" data-caption="main.js"><pre
      class="sourceCode numberSource javascript numberLines"><code class="sourceCode javascript"><span id="cb16-1"><a href="#cb16-1"></a><span class="bu">document</span><span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">&quot;wheel&quot;</span><span class="op">,</span> <span class="kw">function</span>(<span class="bu">event</span>) {</span>
<span id="cb16-2"><a href="#cb16-2"></a>  <span class="co">// イベントが行われたときに実行されるところ</span></span>
<span id="cb16-3"><a href="#cb16-3"></a></span>
<span id="cb16-4"><a href="#cb16-4"></a>  <span class="bu">event</span><span class="op">.</span><span class="fu">preventDefault</span>()<span class="op">;</span></span>
<span id="cb16-5"><a href="#cb16-5"></a>  <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="st">&quot;イベントが発生しました。&quot;</span>)<span class="op">;</span></span>
<span id="cb16-6"><a href="#cb16-6"></a></span>
<span id="cb16-7"><a href="#cb16-7"></a>}<span class="op">,</span> { <span class="dt">passive</span><span class="op">:</span> <span class="kw">false</span> })<span class="op">;</span></span></code></pre></div>
      <ul>
      <li><p>例えば、ホイールでスクロールさせようとしたときに発生するイベントですが、上から下へホイールを動かした際に、ページが上にスクロールしてしまいます。</p></li>
      <li><p>このようなデフォルトの動作を無効にするために、<code>preventDefault();</code>というものがあり、これを書くことで無効にできます。</p></li>
      <li><p>また、詳しい解説は省きますが、<code>preventDefault();</code>を使用した際には、<code>addEventListener</code>の第二引数に
      passive を false
      にすることを宣言しておく必要があります。これをしておかないと、<code>preventDefault();</code>がブラウザによって機能しない可能性があります。</p></li>
      </ul>
      <h2 data-number="4.1" id="イベントリスナーの追加"><span
      class="header-section-number">4.1</span>
      イベントリスナーの追加</h2>
      <ul>
      <li><p>イベントリスナーは、例えば、ボタンをクリックしたとき、マウスを動かしたとき、文字を入力したとき…など、様々なイベントが発生したときに呼び出されます。</p></li>
      <li><p>これを個別で追加することによって、ユーザーが行ったことを検知することができます。</p></li>
      <li><p>以下は、ボタンクリックイベトにリスナーを追加する例です。</p></li>
      </ul>
      <div class="sourceCode" id="cb17" data-caption="index.html"><pre
      class="sourceCode html"><code class="sourceCode html"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">button</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;myButton&quot;</span><span class="dt">&gt;</span>Click me!<span class="dt">&lt;/</span><span class="kw">button</span><span class="dt">&gt;</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">script</span><span class="ot"> src</span><span class="op">=</span><span class="st">&quot;main.js&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">script</span><span class="dt">&gt;</span></span></code></pre></div>
      <div class="sourceCode" id="cb18" data-caption="main.js"><pre
      class="sourceCode numberSource javascript numberLines"><code class="sourceCode javascript"><span id="cb18-1"><a href="#cb18-1"></a><span class="kw">let</span> button <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;myButton&quot;</span>)<span class="op">;</span></span>
<span id="cb18-2"><a href="#cb18-2"></a></span>
<span id="cb18-3"><a href="#cb18-3"></a>button<span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">&#39;click&#39;</span><span class="op">,</span> <span class="kw">function</span>() {</span>
<span id="cb18-4"><a href="#cb18-4"></a></span>
<span id="cb18-5"><a href="#cb18-5"></a>  <span class="fu">alert</span>(<span class="st">&#39;Button was clicked!&#39;</span>)<span class="op">;</span></span>
<span id="cb18-6"><a href="#cb18-6"></a></span>
<span id="cb18-7"><a href="#cb18-7"></a>})<span class="op">;</span></span></code></pre></div>
      <ul>
      <li>この例では、ID が <code>myButton</code>
      のボタンにクリックイベントリスナーを追加しています。ボタンがクリックされると、アラートが表示されます。</li>
      </ul>
      <iframe height="300" style="width: 100%;" scrolling="no" title="btnclick" src="https://codepen.io/YasaiRa-men/embed/vYqapZW?default-tab=html%2Cresult&amp;editable=true" frameborder="no" loading="lazy" allowtransparency="true" allowfullscreen="true">
      See the Pen <a href="https://codepen.io/YasaiRa-men/pen/vYqapZW">
      btnclick</a> by バナナフライ
      (<a href="https://codepen.io/YasaiRa-men"><span class="citation"
      data-cites="YasaiRa-men">@YasaiRa-men</span></a>) on
      <a href="https://codepen.io">CodePen</a>.
      </iframe>
      <ul>
      <li><p>他にも、キーを押したときの<code>keydown</code>、画面をタッチ操作で動かしたときの<code>touchmove</code>,
      マウスを動かしたときの<code>mousemove</code>などもあります。</p></li>
      <li><p>以下の例では、マウスまたは画面を指でスライドしたときに黒丸がその場所に移動するサンプルコードです。</p></li>
      </ul>
      <iframe height="300" style="width: 100%;" scrolling="no" title="Untitled" src="https://codepen.io/YasaiRa-men/embed/abgKZOr?default-tab=html%2Cresult&amp;editable=true" frameborder="no" loading="lazy" allowtransparency="true" allowfullscreen="true">
      See the Pen <a href="https://codepen.io/YasaiRa-men/pen/abgKZOr">
      Untitled</a> by バナナフライ
      (<a href="https://codepen.io/YasaiRa-men"><span class="citation"
      data-cites="YasaiRa-men">@YasaiRa-men</span></a>) on
      <a href="https://codepen.io">CodePen</a>.
      </iframe>
      <ul>
      <li>この丸を主人公に当てはめることで、常にマウスについてくるようになります。</li>
      </ul>
      <h2 data-number="4.2" id="イベントリスナーの削除"><span
      class="header-section-number">4.2</span>
      イベントリスナーの削除</h2>
      <ul>
      <li>イベントリスナーを追加しすぎると、アプリケーションに負荷を与えてしまいます。そのため、不要なイベントリスナーは積極的に削除しましょう。</li>
      <li>イベントリスナーを削除するには、<em>removeEventListener</em>
      メソッドを使います。</li>
      </ul>
      <div class="sourceCode" id="cb19" data-caption="main.js"><pre
      class="sourceCode numberSource javascript numberLines"><code class="sourceCode javascript"><span id="cb19-1"><a href="#cb19-1"></a>element<span class="op">.</span><span class="fu">removeEventListener</span>(eventType<span class="op">,</span> listenerFunction)<span class="op">;</span></span></code></pre></div>
      <div class="note type-intro">
      <ul>
      <li>element: イベントを設定した要素。</li>
      <li>eventType: イベントの種類（例: “click”、“keydown”
      など）。</li>
      <li>listenerFunction:
      削除したいイベントリスナーとして指定した関数。</li>
      </ul>
      </div>
      <div class="note type-quiz">
      <p>Q.
      以下のHTMLとJavaScriptがあったとき、JavaScriptを書き加えてスタートボタンが押されたらスコアの増加が0から始まってストップボタンが押されたらスコアの増加が止まるコードを書いてみよう。
      ヒント：スコアの増加は<u>setInterval</u>で行います。</p>
      <div class="sourceCode" id="cb20" data-caption="index.html"><pre
      class="sourceCode html"><code class="sourceCode html"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">h2</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;Score&quot;</span><span class="dt">&gt;</span>0<span class="dt">&lt;/</span><span class="kw">h2</span><span class="dt">&gt;</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">button</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;startButton&quot;</span><span class="dt">&gt;</span>スタート<span class="dt">&lt;/</span><span class="kw">button</span><span class="dt">&gt;</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">button</span><span class="ot"> id</span><span class="op">=</span><span class="st">&quot;stopButton&quot;</span><span class="dt">&gt;</span>ストップ<span class="dt">&lt;/</span><span class="kw">button</span><span class="dt">&gt;</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">script</span><span class="ot"> src</span><span class="op">=</span><span class="st">&quot;main.js&quot;</span><span class="dt">&gt;&lt;/</span><span class="kw">script</span><span class="dt">&gt;</span></span></code></pre></div>
      <div class="sourceCode" id="cb21" data-caption="main.js"><pre
      class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> scoreElement <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;Score&quot;</span>)<span class="op">;</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> startButton <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;startButton&quot;</span>)<span class="op">;</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> stopButton <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;stopButton&quot;</span>)<span class="op">;</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> score <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> <span class="co">// スコアの初期値</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> scoreInterval<span class="op">;</span> <span class="co">// スコアを増加させるためのタイマー ID</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="co">// スタートボタンのクリックイベント</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>startButton<span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">&quot;click&quot;</span><span class="op">,</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="co">// ここに処理を書く</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="co">// ストップボタンのクリックイベント</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>stopButton<span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">&quot;click&quot;</span><span class="op">,</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a><span class="co">// ここに処理を書く</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span></code></pre></div>
      <div class="quizes">
      <div class="options">
      <div class="option correct">
      答えを見る
      </div>
      </div>
      <div class="answercontent">
      <p>答えの一例です。</p>
      <div class="sourceCode" id="cb22" data-caption="main.js"><pre
      class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> scoreElement <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;Score&quot;</span>)<span class="op">;</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> startButton <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;startButton&quot;</span>)<span class="op">;</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> stopButton <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;stopButton&quot;</span>)<span class="op">;</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> score <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> <span class="co">// スコアの初期値</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> scoreInterval<span class="op">;</span> <span class="co">// スコアを増加させるためのタイマー ID</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="co">// スタートボタンのクリックイベント</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>startButton<span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">&quot;click&quot;</span><span class="op">,</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">// スコアを初期化</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>  score <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>  <span class="co">// スコア増加を開始</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>  scoreInterval <span class="op">=</span> <span class="pp">setInterval</span>(() <span class="kw">=&gt;</span> {</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>    score<span class="op">++;</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>    scoreElement<span class="op">.</span><span class="at">textContent</span> <span class="op">=</span> score<span class="op">;</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span> <span class="dv">10</span>)<span class="op">;</span> <span class="co">// 10ms ごとにスコアを 1 増加</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a><span class="co">// ストップボタンのクリックイベント</span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>stopButton<span class="op">.</span><span class="fu">addEventListener</span>(<span class="st">&quot;click&quot;</span><span class="op">,</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>  <span class="co">// スコア増加を停止</span></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>  <span class="pp">clearInterval</span>(scoreInterval)<span class="op">;</span></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span></code></pre></div>
      <iframe height="300" style="width: 100%;" scrolling="no" title="timer" src="https://codepen.io/YasaiRa-men/embed/ByBzwjW?default-tab=html%2Cresult&amp;editable=true" frameborder="no" loading="lazy" allowtransparency="true" allowfullscreen="true">
      See the Pen <a href="https://codepen.io/YasaiRa-men/pen/ByBzwjW">
      timer</a> by バナナフライ
      (<a href="https://codepen.io/YasaiRa-men"><span class="citation"
      data-cites="YasaiRa-men">@YasaiRa-men</span></a>) on
      <a href="https://codepen.io">CodePen</a>.
      </iframe>
      </div>
      </div>
      </div>
      <h1 data-number="5" id="距離計算"><span
      class="header-section-number">5</span> 距離計算</h1>
      <ul>
      <li><p>障害物に当たるとゲームオーバーになるようにするには、障害物との距離を計算する必要があります。</p></li>
      <li><p>そこで、それぞれの X 座標と Y
      座標は分かっているので、三平方の定理を利用することで距離を求めることができます。</p></li>
      </ul>
      <figure>
      <img src="figs/js/kyori.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <iframe height="300" style="width: 100%;" scrolling="no" title="kyori2" src="https://codepen.io/YasaiRa-men/embed/poXKbpq?default-tab=html%2Cresult&amp;editable=true" frameborder="no" loading="lazy" allowtransparency="true" allowfullscreen="true">
      See the Pen <a href="https://codepen.io/YasaiRa-men/pen/poXKbpq">
      kyori2</a> by バナナフライ
      (<a href="https://codepen.io/YasaiRa-men"><span class="citation"
      data-cites="YasaiRa-men">@YasaiRa-men</span></a>) on
      <a href="https://codepen.io">CodePen</a>.
      </iframe>
      <ul>
      <li><code>getBoundingClientRect()</code>はターゲット要素をの位置をブラウザの表示領域の左上を(0,
      0)として、そこからの相対位置で示されています。これによって自分、または障害物がどこにあるのかを調べることができます。</li>
      </ul>
      <figure>
      <img src="figs/js/zahyou.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <div class="sourceCode" id="cb23" data-caption="script.js"><pre
      class="sourceCode numberSource javascript numberLines"><code class="sourceCode javascript"><span id="cb23-1"><a href="#cb23-1"></a><span class="co">// 自分の位置を取得</span></span>
<span id="cb23-2"><a href="#cb23-2"></a><span class="kw">const</span> circleRect <span class="op">=</span> circle<span class="op">.</span><span class="fu">getBoundingClientRect</span>()<span class="op">;</span></span>
<span id="cb23-3"><a href="#cb23-3"></a><span class="co">// 障害物の位置を取得</span></span>
<span id="cb23-4"><a href="#cb23-4"></a><span class="kw">const</span> obstacleRect <span class="op">=</span> obstacle<span class="op">.</span><span class="fu">getBoundingClientRect</span>()<span class="op">;</span></span></code></pre></div>
      <ul>
      <li><p>距離計算の関数について解説します。</p></li>
      <li><p>距離は、このように計算することで求めることができます。</p></li>
      </ul>
      <p><span class="math display">\[距離=\sqrt{縦^{2} +
      横^{2}}\]</span></p>
      <ul>
      <li>この式を JavaScript で書いてみよう！</li>
      </ul>
      <div class="sourceCode" id="cb24" data-caption="script.js"><pre
      class="sourceCode numberSource javascript numberLines"><code class="sourceCode javascript"><span id="cb24-1"><a href="#cb24-1"></a><span class="co">// 三平方の定理で距離を計算</span></span>
<span id="cb24-2"><a href="#cb24-2"></a><span class="kw">const</span> distance <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">sqrt</span>(<span class="bu">Math</span><span class="op">.</span><span class="fu">pow</span>(circleX <span class="op">-</span> obstacleX<span class="op">,</span> <span class="dv">2</span>) <span class="op">+</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">pow</span>(circleY <span class="op">-</span> obstacleY<span class="op">,</span> <span class="dv">2</span>))<span class="op">;</span></span></code></pre></div>
      <ul>
      <li><p><code>Math.pow()</code>は、累乗を計算できるもので、第一引数には累乗させたい数、第二引数には指数を書きます。上記の例だとそれぞれ自分の位置から障害物までの位置の差を取って、2
      乗していることが分かります。</p></li>
      <li><p><code>Math.sqrt()</code>は、平方根を表します。</p></li>
      <li><p>これらによって、<code>distance</code>に計算された距離を代入されていることが分かりますね！</p></li>
      <li><p>テキストについての処理はここで行われています。</p></li>
      </ul>
      <div class="sourceCode" id="cb25" data-caption="script.js"><pre
      class="sourceCode numberSource javascript numberLines"><code class="sourceCode javascript"><span id="cb25-1"><a href="#cb25-1"></a><span class="co">// 距離をテキストで表示</span></span>
<span id="cb25-2"><a href="#cb25-2"></a>distanceText<span class="op">.</span><span class="at">textContent</span> <span class="op">=</span> <span class="st">&#39;Distance: &#39;</span> <span class="op">+</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">round</span>(distance) <span class="op">+</span> <span class="st">&#39;px&#39;</span><span class="op">;</span></span>
<span id="cb25-3"><a href="#cb25-3"></a></span>
<span id="cb25-4"><a href="#cb25-4"></a><span class="co">// 衝突判定 (2つの半径の和より距離が小さい場合)</span></span>
<span id="cb25-5"><a href="#cb25-5"></a><span class="kw">const</span> radiusSum <span class="op">=</span> circleRect<span class="op">.</span><span class="at">width</span> <span class="op">/</span> <span class="dv">2</span> <span class="op">+</span> obstacleRect<span class="op">.</span><span class="at">width</span> <span class="op">/</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb25-6"><a href="#cb25-6"></a></span>
<span id="cb25-7"><a href="#cb25-7"></a><span class="cf">if</span> (distance <span class="op">&lt;=</span> radiusSum) {</span>
<span id="cb25-8"><a href="#cb25-8"></a>    collisionText<span class="op">.</span><span class="at">textContent</span> <span class="op">=</span> <span class="st">&#39;当たり判定：障害物に当たっています！&#39;</span><span class="op">;</span></span>
<span id="cb25-9"><a href="#cb25-9"></a>} <span class="cf">else</span> {</span>
<span id="cb25-10"><a href="#cb25-10"></a>    collisionText<span class="op">.</span><span class="at">textContent</span> <span class="op">=</span> <span class="st">&#39;当たり判定：障害物に当たっていません&#39;</span><span class="op">;</span></span>
<span id="cb25-11"><a href="#cb25-11"></a>}</span></code></pre></div>
      <ul>
      <li><p>Math.round()は小数点以下を四捨五入できるものとなってます。試しに<code>Math.round(distance)</code>のところを<code>distance</code>に変更
      してみるとどんな変化があるのか試してみよう！</p></li>
      <li><p>下の条件分岐では、計算された距離が自分と障害物の丸の半径の合計より小さい場合、つまり当たっている場合で表示するテキストを変えています。</p></li>
      </ul>
      <h1 data-number="6" id="まとめ"><span
      class="header-section-number">6</span> まとめ</h1>
      <ul>
      <li>このセクションでは、JavaScript
      を使って、避けゲーの基盤となる部分を作成しました。</li>
      </ul>
      <hr />
      <p>次回はこれらを組み合わせて実際にゲーム作りにとりかかりましょう！</p>
      <!-- ---------------------------------------- -->
    </main>

    <footer class="markdown-body">
      <p><a href="index.html">講義資料のIndexに移動</a></p>
    </footer>

    <script>
      window.onload = function () {
        // ナビゲーション関連
        let openBtn = document.getElementsByClassName("openbtn")[0];
        let navPnl = document.getElementById("g-nav");
        openBtn.onclick = () => {
          openBtn.classList.toggle("active");
          navPnl.classList.toggle("panelactive");
        };

        let items = navPnl.getElementsByTagName("a");
        Array.from(items).forEach((item) => {
          item.onclick = () => {
            openBtn.classList.toggle("active");
            navPnl.classList.toggle("panelactive");
          };
        });

        // マスク処理
        let maskedSpans = document.getElementsByClassName("masked");
        Array.from(maskedSpans).forEach((span) => {
          span.onclick = () => {
            span.classList.toggle("open");
          };
        });

        // クリック処理
        let options = document.getElementsByClassName("quizes");
        Array.from(options).forEach((option) => {
          option.addEventListener('click', function() {
            let correctOption = this.querySelector('.correct');
            let incorrectOptions = this.querySelectorAll('.incorrect');
            let answercontentOption = this.querySelector('.answercontent');

            // rgb(120, 239, 111) == #78ef6f
            if (correctOption.style.backgroundColor != 'rgb(120, 239, 111)') {
              correctOption.style.backgroundColor = '#78ef6f';
              correctOption.style.color = '#000000';
            
              incorrectOptions.forEach((incorrect) => {
                incorrect.style.backgroundColor = '#ef6f6f';
                incorrect.style.color = '#000000';
              });

              answercontentOption.style.height = "100%";
            } else {
              correctOption.style.backgroundColor = '#dedede';
              correctOption.style.color = '#000000';
            
              incorrectOptions.forEach((incorrect) => {
                incorrect.style.backgroundColor = '#dedede';
                incorrect.style.color = '#000000';
              });

              answercontentOption.style.height = "0px";
            }
          });
        });

        // data-startfrom 属性の行番号カウンタのリセット
        document.querySelectorAll("div.sourceCode").forEach(function (div) {
          var startFrom = div.getAttribute("data-startfrom");
          if (startFrom != null) {
            div.style.counterReset = "pg-line " + (startFrom - 1);
          }
        });

        // 画像にリンクを付与
        // let images = document.querySelectorAll("figure img");
        // Array.from(images).forEach((img) => {
        //   img.onclick = () => {
        //     location.href = img.getAttribute("src");
        //   };
        // });
      };
    </script>
  </body>
</html>
